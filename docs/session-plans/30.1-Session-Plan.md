# Session 30.1: ViewModels + CSS Foundation

**Parent Plan**: `30-Session-Plan.md`
**Target**: ~40k tokens
**Prerequisites**: .NET 10 SDK, Radzen.Blazor 8.6.2+, Session 20 complete

---

## Scope

This session implements the foundational ViewModels and CSS design system:

1. **Store Interface Updates** (Prerequisites) - Add IsPending() method to stores
2. **ViewModel Infrastructure** (Files 1-4) - Base interface, WorkItemViewModel, SprintViewModel, Factory
3. **CSS Design System** (Files 5-8) - app.css, work-items.css, kanban.css, layout.css

---

## Prerequisites: Store Interface Updates

**CRITICAL**: These changes MUST be made before implementing ANY Session 30 code.

### 1. Update IWorkItemStore.cs

```csharp
// Add this method to the interface
/// <summary>Check if a work item has a pending optimistic update.</summary>
bool IsPending(Guid id);
```

### 2. Update ISprintStore.cs

```csharp
// Add this method to the interface
/// <summary>Check if a sprint has a pending optimistic update.</summary>
bool IsPending(Guid id);
```

### 3. Update WorkItemStore.cs

```csharp
// Add implementation
public bool IsPending(Guid id) => _pendingUpdates.ContainsKey(id);
```

### 4. Update SprintStore.cs

```csharp
// Add field (if not already present)
private readonly ConcurrentDictionary<Guid, bool> _pendingUpdates = new();

// Add implementation
public bool IsPending(Guid id) => _pendingUpdates.ContainsKey(id);

// Update write operations to track pending state:
// In CreateAsync, UpdateAsync, StartSprintAsync, CompleteSprintAsync, DeleteAsync:
// Add: _pendingUpdates[id] = true; before the async call
// Remove: _pendingUpdates.TryRemove(id, out _); in finally block
```

### 5. Verification

```bash
cd frontend
dotnet build ProjectManagement.Core
dotnet build ProjectManagement.Services
dotnet test ProjectManagement.Services.Tests
# All must pass before proceeding
```

---

## Implementation Order

### Step 1: Create IViewModel Interface

**Create**: `frontend/ProjectManagement.Core/ViewModels/IViewModel.cs`

```csharp
namespace ProjectManagement.Core.ViewModels;

/// <summary>
/// Base interface for all view models.
/// View models combine immutable domain models with transient UI state.
/// </summary>
/// <typeparam name="TModel">The underlying domain model type</typeparam>
public interface IViewModel<out TModel> where TModel : class
{
    /// <summary>
    /// The underlying domain model (from server/store).
    /// This is immutable - UI changes create new ViewModels.
    /// </summary>
    TModel Model { get; }

    /// <summary>
    /// True when this item has pending changes being synced to the server.
    /// Used for optimistic UI feedback (shimmer effect, disabled buttons, etc.)
    /// </summary>
    bool IsPendingSync { get; }
}
```

**Verification**: `dotnet build ProjectManagement.Core`

---

### Step 2: Create WorkItemViewModel

**Create**: `frontend/ProjectManagement.Core/ViewModels/WorkItemViewModel.cs`

```csharp
using ProjectManagement.Core.Models;

namespace ProjectManagement.Core.ViewModels;

/// <summary>
/// View model for WorkItem. Combines immutable domain data with UI state.
/// Exposes commonly-accessed properties for convenient Razor binding.
/// </summary>
public sealed class WorkItemViewModel : IViewModel<WorkItem>, IEquatable<WorkItemViewModel>
{
    public WorkItemViewModel(WorkItem model, bool isPendingSync = false)
    {
        ArgumentNullException.ThrowIfNull(model);
        Model = model;
        IsPendingSync = isPendingSync;
    }

    public WorkItem Model { get; }
    public bool IsPendingSync { get; }

    // === Identity ===
    public Guid Id => Model.Id;
    public int Version => Model.Version;

    // === Core Properties ===
    public WorkItemType ItemType => Model.ItemType;
    public string Title => Model.Title;
    public string? Description => Model.Description;
    public string Status => Model.Status;
    public string Priority => Model.Priority;
    public int? StoryPoints => Model.StoryPoints;
    public int Position => Model.Position;

    // === Relationships ===
    public Guid ProjectId => Model.ProjectId;
    public Guid? ParentId => Model.ParentId;
    public Guid? SprintId => Model.SprintId;
    public Guid? AssigneeId => Model.AssigneeId;

    // === Audit ===
    public Guid CreatedBy => Model.CreatedBy;
    public Guid UpdatedBy => Model.UpdatedBy;
    public DateTime CreatedAt => Model.CreatedAt;
    public DateTime UpdatedAt => Model.UpdatedAt;
    public DateTime? DeletedAt => Model.DeletedAt;

    // === Computed Properties ===
    public bool IsDeleted => Model.DeletedAt.HasValue;
    public bool IsCompleted => Model.Status == "done";

    public string StatusDisplayName => Status switch
    {
        "backlog" => "Backlog",
        "todo" => "To Do",
        "in_progress" => "In Progress",
        "review" => "Review",
        "done" => "Done",
        _ => Status
    };

    public string PriorityDisplayName => Priority switch
    {
        "critical" => "Critical",
        "high" => "High",
        "medium" => "Medium",
        "low" => "Low",
        _ => Priority
    };

    public string ItemTypeDisplayName => ItemType switch
    {
        WorkItemType.Project => "Project",
        WorkItemType.Epic => "Epic",
        WorkItemType.Story => "Story",
        WorkItemType.Task => "Task",
        _ => ItemType.ToString()
    };

    /// <summary>
    /// Priority sort order (lower = more urgent).
    /// </summary>
    public int PrioritySortOrder => Priority switch
    {
        "critical" => 0,
        "high" => 1,
        "medium" => 2,
        "low" => 3,
        _ => 4
    };

    // === Equality ===
    public bool Equals(WorkItemViewModel? other)
    {
        if (other is null) return false;
        if (ReferenceEquals(this, other)) return true;
        return Id == other.Id && Version == other.Version && IsPendingSync == other.IsPendingSync;
    }

    public override bool Equals(object? obj) => Equals(obj as WorkItemViewModel);

    public override int GetHashCode() => HashCode.Combine(Id, Version, IsPendingSync);

    public static bool operator ==(WorkItemViewModel? left, WorkItemViewModel? right) =>
        left?.Equals(right) ?? right is null;

    public static bool operator !=(WorkItemViewModel? left, WorkItemViewModel? right) =>
        !(left == right);
}
```

**Verification**: `dotnet build ProjectManagement.Core`

---

### Step 3: Create SprintViewModel

**Create**: `frontend/ProjectManagement.Core/ViewModels/SprintViewModel.cs`

```csharp
using ProjectManagement.Core.Models;

namespace ProjectManagement.Core.ViewModels;

/// <summary>
/// View model for Sprint. Combines immutable domain data with UI state.
/// Note: Sprint.StartDate and Sprint.EndDate are non-nullable (per Session 20).
/// </summary>
public sealed class SprintViewModel : IViewModel<Sprint>, IEquatable<SprintViewModel>
{
    public SprintViewModel(Sprint model, bool isPendingSync = false)
    {
        ArgumentNullException.ThrowIfNull(model);
        Model = model;
        IsPendingSync = isPendingSync;
    }

    public Sprint Model { get; }
    public bool IsPendingSync { get; }

    // === Identity ===
    public Guid Id => Model.Id;
    public Guid ProjectId => Model.ProjectId;

    // === Core Properties ===
    public string Name => Model.Name;
    public string? Goal => Model.Goal;
    public DateTime StartDate => Model.StartDate;
    public DateTime EndDate => Model.EndDate;
    public SprintStatus Status => Model.Status;

    // === Audit ===
    public DateTime? DeletedAt => Model.DeletedAt;

    // === Computed Properties ===
    public bool IsDeleted => Model.DeletedAt.HasValue;
    public bool IsPlanned => Model.Status == SprintStatus.Planned;
    public bool IsActive => Model.Status == SprintStatus.Active;
    public bool IsCompleted => Model.Status == SprintStatus.Completed;

    public string StatusDisplayName => Status switch
    {
        SprintStatus.Planned => "Planned",
        SprintStatus.Active => "Active",
        SprintStatus.Completed => "Completed",
        _ => Status.ToString()
    };

    /// <summary>
    /// Formatted date range for display (e.g., "Jan 15 - Jan 29").
    /// </summary>
    public string DateRangeDisplay => $"{StartDate:MMM d} - {EndDate:MMM d}";

    /// <summary>
    /// Full date range with year for clarity.
    /// </summary>
    public string DateRangeDisplayFull => $"{StartDate:MMM d, yyyy} - {EndDate:MMM d, yyyy}";

    /// <summary>
    /// Days remaining in the sprint (only meaningful when Active).
    /// Returns null if sprint is not active.
    /// </summary>
    public int? DaysRemaining
    {
        get
        {
            if (Status != SprintStatus.Active) return null;
            var remaining = (EndDate.Date - DateTime.UtcNow.Date).TotalDays;
            return Math.Max(0, (int)remaining);
        }
    }

    /// <summary>
    /// Total duration of the sprint in days.
    /// </summary>
    public int DurationDays => Math.Max(1, (int)(EndDate.Date - StartDate.Date).TotalDays);

    /// <summary>
    /// Progress percentage through the sprint (0-100).
    /// Based on elapsed time, not completed work.
    /// </summary>
    public double ProgressPercent
    {
        get
        {
            if (Status == SprintStatus.Completed) return 100;
            if (Status == SprintStatus.Planned) return 0;

            var total = (EndDate - StartDate).TotalDays;
            if (total <= 0) return 100;

            var elapsed = (DateTime.UtcNow - StartDate).TotalDays;
            return Math.Clamp(elapsed / total * 100, 0, 100);
        }
    }

    /// <summary>
    /// True if the sprint has passed its end date but is not yet completed.
    /// </summary>
    public bool IsOverdue => Status == SprintStatus.Active && DateTime.UtcNow.Date > EndDate.Date;

    // === Equality ===
    public bool Equals(SprintViewModel? other)
    {
        if (other is null) return false;
        if (ReferenceEquals(this, other)) return true;
        return Id == other.Id && Status == other.Status && IsPendingSync == other.IsPendingSync;
    }

    public override bool Equals(object? obj) => Equals(obj as SprintViewModel);

    public override int GetHashCode() => HashCode.Combine(Id, Status, IsPendingSync);

    public static bool operator ==(SprintViewModel? left, SprintViewModel? right) =>
        left?.Equals(right) ?? right is null;

    public static bool operator !=(SprintViewModel? left, SprintViewModel? right) =>
        !(left == right);
}
```

**Verification**: `dotnet build ProjectManagement.Core`

---

### Step 4: Create ViewModelFactory

**Create**: `frontend/ProjectManagement.Core/ViewModels/ViewModelFactory.cs`

```csharp
using ProjectManagement.Core.Interfaces;
using ProjectManagement.Core.Models;

namespace ProjectManagement.Core.ViewModels;

/// <summary>
/// Factory for creating ViewModels with proper pending state.
/// Registered as Scoped service to access stores.
/// </summary>
public sealed class ViewModelFactory
{
    private readonly IWorkItemStore _workItemStore;
    private readonly ISprintStore _sprintStore;

    public ViewModelFactory(IWorkItemStore workItemStore, ISprintStore sprintStore)
    {
        ArgumentNullException.ThrowIfNull(workItemStore);
        ArgumentNullException.ThrowIfNull(sprintStore);
        _workItemStore = workItemStore;
        _sprintStore = sprintStore;
    }

    /// <summary>
    /// Create a WorkItemViewModel from a WorkItem, checking pending state.
    /// </summary>
    public WorkItemViewModel Create(WorkItem item)
    {
        ArgumentNullException.ThrowIfNull(item);
        var isPending = _workItemStore.IsPending(item.Id);
        return new WorkItemViewModel(item, isPending);
    }

    /// <summary>
    /// Create a SprintViewModel from a Sprint, checking pending state.
    /// </summary>
    public SprintViewModel Create(Sprint sprint)
    {
        ArgumentNullException.ThrowIfNull(sprint);
        var isPending = _sprintStore.IsPending(sprint.Id);
        return new SprintViewModel(sprint, isPending);
    }

    /// <summary>
    /// Create ViewModels for multiple work items.
    /// </summary>
    public IReadOnlyList<WorkItemViewModel> CreateMany(IEnumerable<WorkItem> items)
    {
        ArgumentNullException.ThrowIfNull(items);
        return items.Select(Create).ToList();
    }

    /// <summary>
    /// Create ViewModels for multiple sprints.
    /// </summary>
    public IReadOnlyList<SprintViewModel> CreateMany(IEnumerable<Sprint> sprints)
    {
        ArgumentNullException.ThrowIfNull(sprints);
        return sprints.Select(Create).ToList();
    }

    /// <summary>
    /// Create a WorkItemViewModel with explicit pending state (for optimistic creates).
    /// </summary>
    public WorkItemViewModel CreateWithPendingState(WorkItem item, bool isPending)
    {
        ArgumentNullException.ThrowIfNull(item);
        return new WorkItemViewModel(item, isPending);
    }

    /// <summary>
    /// Create a SprintViewModel with explicit pending state (for optimistic creates).
    /// </summary>
    public SprintViewModel CreateWithPendingState(Sprint sprint, bool isPending)
    {
        ArgumentNullException.ThrowIfNull(sprint);
        return new SprintViewModel(sprint, isPending);
    }
}
```

**Verification**: `dotnet build ProjectManagement.Core`

---

### Step 5: Create app.css

**Create**: `frontend/ProjectManagement.Components/wwwroot/css/app.css`

```css
/* =============================================================================
   APP.CSS - Global application styles
   ============================================================================= */

/* === Skip Link (Accessibility) === */
.skip-link {
    position: absolute;
    top: -40px;
    left: 0;
    background: var(--rz-primary);
    color: white;
    padding: 8px 16px;
    z-index: 10000;
    text-decoration: none;
    border-radius: 0 0 4px 0;
    font-weight: 500;
}

.skip-link:focus {
    top: 0;
}

/* === Visually Hidden (Screen Reader Only) === */
.visually-hidden {
    position: absolute !important;
    width: 1px !important;
    height: 1px !important;
    padding: 0 !important;
    margin: -1px !important;
    overflow: hidden !important;
    clip: rect(0, 0, 0, 0) !important;
    white-space: nowrap !important;
    border: 0 !important;
}

/* === Offline Banner === */
.offline-banner {
    background: var(--rz-warning-lighter);
    border-bottom: 1px solid var(--rz-warning);
    padding: 0.5rem 1rem;
    color: var(--rz-warning-darker);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.offline-banner .rzi {
    flex-shrink: 0;
}

/* === Empty State === */
.empty-state {
    padding: 3rem 1rem;
    text-align: center;
}

.empty-state-icon {
    font-size: 3rem;
    color: var(--rz-text-tertiary-color);
    margin-bottom: 1rem;
}

.empty-state-title {
    margin: 0 0 0.5rem 0;
    color: var(--rz-text-color);
}

.empty-state-description {
    color: var(--rz-text-secondary-color);
    max-width: 300px;
    margin: 0 auto 1rem auto;
}

/* === Pending Sync Animation === */
.pending-sync {
    opacity: 0.7;
    background: linear-gradient(
        90deg,
        var(--rz-base-200) 0%,
        var(--rz-base-100) 50%,
        var(--rz-base-200) 100%
    );
    background-size: 200% 100%;
    animation: shimmer 1.5s infinite;
}

@keyframes shimmer {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
}

/* === Focus Visible (Keyboard Navigation) === */
.focus-visible:focus-visible,
*:focus-visible {
    outline: 2px solid var(--rz-primary);
    outline-offset: 2px;
}

/* === Utility Classes === */
.flex-grow-1 { flex-grow: 1; }
.flex-shrink-0 { flex-shrink: 0; }

.text-start { text-align: start; }
.text-center { text-align: center; }
.text-end { text-align: end; }

.text-muted { color: var(--rz-text-secondary-color); }
.text-tertiary { color: var(--rz-text-tertiary-color); }

.w-100 { width: 100%; }
.h-100 { height: 100%; }

.gap-0 { gap: 0; }
.gap-1 { gap: 0.25rem; }
.gap-2 { gap: 0.5rem; }
.gap-3 { gap: 0.75rem; }
.gap-4 { gap: 1rem; }
.gap-5 { gap: 1.5rem; }

.m-0 { margin: 0; }
.mt-1 { margin-top: 0.25rem; }
.mt-2 { margin-top: 0.5rem; }
.mt-3 { margin-top: 0.75rem; }
.mt-4 { margin-top: 1rem; }
.mb-1 { margin-bottom: 0.25rem; }
.mb-2 { margin-bottom: 0.5rem; }
.mb-3 { margin-bottom: 0.75rem; }
.mb-4 { margin-bottom: 1rem; }

.p-0 { padding: 0; }
.p-1 { padding: 0.25rem; }
.p-2 { padding: 0.5rem; }
.p-3 { padding: 0.75rem; }
.p-4 { padding: 1rem; }

/* === Truncate Text === */
.text-truncate {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.text-truncate-2 {
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
}

/* === Reduced Motion === */
@media (prefers-reduced-motion: reduce) {
    .pending-sync {
        animation: none;
        opacity: 0.6;
    }

    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

/* === High Contrast Mode === */
@media (prefers-contrast: high) {
    .pending-sync {
        border: 2px dashed currentColor;
    }

    .empty-state-icon {
        color: currentColor;
    }
}
```

**Verification**: File exists in correct location

---

### Step 6: Create work-items.css

**Create**: `frontend/ProjectManagement.Components/wwwroot/css/work-items.css`

```css
/* =============================================================================
   WORK-ITEMS.CSS - Work item list and row styles
   ============================================================================= */

/* === Work Item List Container === */
.work-item-list {
    border: 1px solid var(--rz-border-color);
    border-radius: 8px;
    overflow: hidden;
    background: var(--rz-surface);
}

/* === Header Row === */
.work-item-header {
    display: flex;
    background: var(--rz-base-200);
    border-bottom: 1px solid var(--rz-border-color);
    font-weight: 600;
    font-size: 0.875rem;
    color: var(--rz-text-secondary-color);
}

/* === Data Row === */
.work-item-row {
    display: flex;
    border-bottom: 1px solid var(--rz-border-color);
    transition: background-color 0.15s ease;
    cursor: pointer;
}

.work-item-row:last-child {
    border-bottom: none;
}

.work-item-row:hover {
    background-color: var(--rz-secondary-lighter);
}

.work-item-row:focus-visible {
    outline: 2px solid var(--rz-primary);
    outline-offset: -2px;
    z-index: 1;
    position: relative;
}

/* === Row States === */
.work-item-row.status-done {
    opacity: 0.7;
}

.work-item-row.status-done .work-item-title {
    text-decoration: line-through;
    color: var(--rz-text-secondary-color);
}

.work-item-row.pending-sync {
    opacity: 0.7;
    background: linear-gradient(
        90deg,
        var(--rz-base-200) 0%,
        var(--rz-base-100) 50%,
        var(--rz-base-200) 100%
    );
    background-size: 200% 100%;
    animation: shimmer 1.5s infinite;
    pointer-events: none;
}

/* === Cell Styles === */
.work-item-cell {
    padding: 0.75rem;
    display: flex;
    align-items: center;
    min-height: 52px;
}

.type-cell {
    width: 60px;
    justify-content: center;
    flex-shrink: 0;
}

.title-cell {
    flex: 1;
    min-width: 200px;
    overflow: hidden;
}

.status-cell {
    width: 120px;
    flex-shrink: 0;
}

.priority-cell {
    width: 100px;
    flex-shrink: 0;
}

.points-cell {
    width: 80px;
    justify-content: center;
    flex-shrink: 0;
}

.actions-cell {
    width: 100px;
    justify-content: flex-end;
    flex-shrink: 0;
}

/* === Title Styling === */
.work-item-title {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    color: var(--rz-text-color);
}

.work-item-title:hover {
    color: var(--rz-primary);
}

/* === Hierarchy Indent === */
.hierarchy-indent {
    display: inline-block;
    flex-shrink: 0;
}

/* === Responsive === */
@media (max-width: 992px) {
    .points-cell {
        display: none;
    }
}

@media (max-width: 768px) {
    .priority-cell {
        display: none;
    }

    .actions-cell {
        width: 80px;
    }

    .title-cell {
        min-width: 150px;
    }
}

@media (max-width: 576px) {
    .status-cell {
        width: 100px;
    }

    .actions-cell {
        width: 60px;
    }
}

/* === Reduced Motion === */
@media (prefers-reduced-motion: reduce) {
    .work-item-row {
        transition: none;
    }

    .work-item-row.pending-sync {
        animation: none;
    }
}
```

**Verification**: File exists in correct location

---

### Step 7: Create kanban.css

**Create**: `frontend/ProjectManagement.Components/wwwroot/css/kanban.css`

```css
/* =============================================================================
   KANBAN.CSS - Kanban board and card styles
   ============================================================================= */

/* === Board Container === */
.kanban-board {
    min-height: 500px;
}

/* === Columns Container === */
.kanban-columns {
    display: flex;
    gap: 1rem;
    overflow-x: auto;
    padding-bottom: 1rem;
    min-height: 400px;
    scroll-behavior: smooth;
}

/* === Single Column === */
.kanban-column {
    flex: 0 0 280px;
    background: var(--rz-base-200);
    border-radius: 8px;
    display: flex;
    flex-direction: column;
    max-height: calc(100vh - 250px);
    min-height: 300px;
    transition: box-shadow 0.2s ease, background-color 0.2s ease;
}

.kanban-column.drag-target {
    box-shadow: 0 0 0 2px var(--rz-primary);
    background: var(--rz-primary-lighter);
}

/* === Column Header === */
.kanban-column-header {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid var(--rz-border-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0;
    background: var(--rz-base-300);
    border-radius: 8px 8px 0 0;
}

.kanban-column-title {
    font-weight: 600;
    margin: 0;
}

/* === Column Body === */
.kanban-column-body {
    flex: 1;
    overflow-y: auto;
    padding: 0.5rem;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

/* === Empty Column === */
.kanban-empty-column {
    padding: 2rem 1rem;
    text-align: center;
    color: var(--rz-text-tertiary-color);
    font-size: 0.875rem;
}

/* === Kanban Card === */
.kanban-card {
    background: var(--rz-surface);
    border: 1px solid var(--rz-border-color);
    border-radius: 6px;
    padding: 0.75rem;
    cursor: grab;
    transition: box-shadow 0.15s ease, transform 0.15s ease, opacity 0.15s ease;
    user-select: none;
}

.kanban-card:hover {
    box-shadow: var(--rz-shadow-2);
}

.kanban-card:focus-visible {
    outline: 2px solid var(--rz-primary);
    outline-offset: 2px;
}

/* === Card Dragging State === */
.kanban-card:active,
.kanban-card[aria-grabbed="true"],
.kanban-card.dragging {
    cursor: grabbing;
    transform: rotate(2deg);
    box-shadow: var(--rz-shadow-3);
    opacity: 0.9;
}

/* === Card Pending State === */
.kanban-card.pending-sync {
    opacity: 0.6;
    pointer-events: none;
    cursor: default;
    background: linear-gradient(
        90deg,
        var(--rz-base-200) 0%,
        var(--rz-base-100) 50%,
        var(--rz-base-200) 100%
    );
    background-size: 200% 100%;
    animation: shimmer 1.5s infinite;
}

/* === Card Title === */
.kanban-card-title {
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    word-break: break-word;
    font-size: 0.875rem;
    line-height: 1.4;
}

/* === Card Footer === */
.kanban-card-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-top: 0.5rem;
    padding-top: 0.5rem;
    border-top: 1px solid var(--rz-border-color);
}

/* === Drop Indicator === */
.kanban-drop-indicator {
    height: 2px;
    background: var(--rz-primary);
    margin: 0.25rem 0;
    border-radius: 1px;
}

/* === Responsive === */
@media (max-width: 768px) {
    .kanban-column {
        flex: 0 0 260px;
    }
}

@media (max-width: 576px) {
    .kanban-column {
        flex: 0 0 240px;
    }

    .kanban-card {
        padding: 0.5rem;
    }
}

/* === Reduced Motion === */
@media (prefers-reduced-motion: reduce) {
    .kanban-card {
        transition: none;
    }

    .kanban-card:active,
    .kanban-card.dragging {
        transform: none;
    }

    .kanban-card.pending-sync {
        animation: none;
    }

    .kanban-columns {
        scroll-behavior: auto;
    }
}

/* === High Contrast === */
@media (prefers-contrast: high) {
    .kanban-column {
        border: 2px solid currentColor;
    }

    .kanban-card {
        border: 2px solid currentColor;
    }

    .kanban-column.drag-target {
        border-style: dashed;
    }
}
```

**Verification**: File exists in correct location

---

### Step 8: Create layout.css

**Create**: `frontend/ProjectManagement.Components/wwwroot/css/layout.css`

```css
/* =============================================================================
   LAYOUT.CSS - Page layout, headers, and structural styles
   ============================================================================= */

/* === CSS Custom Properties === */
:root {
    --header-height: 50px;
    --sidebar-width: 250px;
    --sidebar-collapsed-width: 60px;
    --content-padding: 1.5rem;
    --transition-speed: 0.2s;
}

/* === Page Header === */
.page-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1.5rem;
    flex-wrap: wrap;
    gap: 1rem;
}

.page-title {
    margin: 0;
    font-size: 1.5rem;
    font-weight: 600;
    color: var(--rz-text-color);
}

.page-subtitle {
    margin: 0.25rem 0 0 0;
    font-size: 0.875rem;
    color: var(--rz-text-secondary-color);
}

.page-actions {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

/* === Breadcrumbs === */
.breadcrumbs {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
    font-size: 0.875rem;
    color: var(--rz-text-secondary-color);
    flex-wrap: wrap;
}

.breadcrumbs a {
    color: var(--rz-primary);
    text-decoration: none;
    transition: color 0.15s ease;
}

.breadcrumbs a:hover {
    text-decoration: underline;
}

.breadcrumbs a:focus-visible {
    outline: 2px solid var(--rz-primary);
    outline-offset: 2px;
}

.breadcrumbs .separator {
    color: var(--rz-text-tertiary-color);
}

.breadcrumbs .current {
    color: var(--rz-text-color);
    font-weight: 500;
}

/* === Content Cards === */
.content-card {
    background: var(--rz-surface);
    border: 1px solid var(--rz-border-color);
    border-radius: 8px;
    padding: 1.5rem;
}

.content-card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--rz-border-color);
}

.content-card-title {
    margin: 0;
    font-size: 1.125rem;
    font-weight: 600;
}

.content-card-actions {
    display: flex;
    gap: 0.5rem;
}

/* === View Tabs === */
.view-tabs {
    margin-bottom: 1rem;
    border-bottom: 1px solid var(--rz-border-color);
}

.view-tab {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    border: none;
    background: transparent;
    color: var(--rz-text-secondary-color);
    font-size: 0.875rem;
    font-weight: 500;
    cursor: pointer;
    border-bottom: 2px solid transparent;
    margin-bottom: -1px;
    transition: color 0.15s ease, border-color 0.15s ease;
}

.view-tab:hover {
    color: var(--rz-text-color);
}

.view-tab:focus-visible {
    outline: 2px solid var(--rz-primary);
    outline-offset: -2px;
}

.view-tab.active {
    color: var(--rz-primary);
    border-bottom-color: var(--rz-primary);
}

/* === Stat Cards === */
.stat-card {
    background: var(--rz-surface);
    border: 1px solid var(--rz-border-color);
    border-radius: 8px;
    padding: 1rem;
}

.stat-card-value {
    font-size: 2rem;
    font-weight: 700;
    color: var(--rz-text-color);
    line-height: 1;
}

.stat-card-label {
    font-size: 0.875rem;
    color: var(--rz-text-secondary-color);
    margin-top: 0.25rem;
}

/* === Dividers === */
.divider {
    height: 1px;
    background: var(--rz-border-color);
    margin: 1rem 0;
}

.divider-vertical {
    width: 1px;
    height: 100%;
    background: var(--rz-border-color);
    margin: 0 1rem;
}

/* === Responsive === */
@media (max-width: 768px) {
    .page-header {
        flex-direction: column;
        align-items: flex-start;
    }

    .page-actions {
        width: 100%;
    }

    .content-card {
        padding: 1rem;
    }

    .content-card-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
    }
}

/* === Reduced Motion === */
@media (prefers-reduced-motion: reduce) {
    .view-tab,
    .breadcrumbs a {
        transition: none;
    }
}
```

**Verification**: File exists in correct location

---

## Session 30.1 Completion Checklist

After completing all steps:

- [ ] `dotnet build ProjectManagement.Core` passes
- [ ] `dotnet build ProjectManagement.Components` passes
- [ ] All 4 CSS files created in wwwroot/css/
- [ ] ViewModels folder created with 4 files

### Files Created (8)

| File | Purpose |
|------|---------|
| `Core/ViewModels/IViewModel.cs` | Base ViewModel interface |
| `Core/ViewModels/WorkItemViewModel.cs` | Work item ViewModel with display names |
| `Core/ViewModels/SprintViewModel.cs` | Sprint ViewModel with computed properties |
| `Core/ViewModels/ViewModelFactory.cs` | Factory with pending state awareness |
| `Components/wwwroot/css/app.css` | Global styles, utilities, accessibility |
| `Components/wwwroot/css/work-items.css` | List and row styles |
| `Components/wwwroot/css/kanban.css` | Kanban board and card styles |
| `Components/wwwroot/css/layout.css` | Page layout, headers, cards |

### Files Modified (4)

| File | Change |
|------|--------|
| `Core/Interfaces/IWorkItemStore.cs` | Add IsPending() method |
| `Core/Interfaces/ISprintStore.cs` | Add IsPending() method |
| `Services/State/WorkItemStore.cs` | Implement IsPending() |
| `Services/State/SprintStore.cs` | Implement IsPending() |

---

## Next Session

**Session 30.2** will implement:
- _Imports.razor for Components project
- All leaf components (OfflineBanner, EmptyState, LoadingButton, etc.)
- Badge components (WorkItemTypeIcon, WorkItemStatusBadge, PriorityBadge)
