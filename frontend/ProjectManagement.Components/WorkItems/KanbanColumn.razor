@using ProjectManagement.Core.ViewModels

<div class="kanban-column @(IsKeyboardDragTarget ? "drag-target" : "")"
     role="listbox"
     aria-label="@($"{Title} column, {ItemCount} items")">

    <RadzenDropZone TItem="WorkItemViewModel" Value="@Status">
        @* Header *@
        <div class="kanban-column-header">
            <RadzenText TextStyle="TextStyle.Subtitle1" class="m-0">@Title</RadzenText>
            <RadzenBadge BadgeStyle="@HeaderBadgeStyle" Text="@ItemCount.ToString()" IsPill="true" />
        </div>

        @* Empty state *@
        @if (ItemCount == 0)
        {
            <div class="kanban-empty-column">
                <RadzenIcon Icon="inbox" Style="font-size: 1.5rem; opacity: 0.5;" />
                <RadzenText TextStyle="TextStyle.Caption" class="text-muted mt-2">No items</RadzenText>
            </div>
        }
    </RadzenDropZone>
</div>

@code {
    [Parameter, EditorRequired] public string Status { get; set; } = "";

    [Parameter, EditorRequired] public string Title { get; set; } = "";

    [Parameter] public IEnumerable<WorkItemViewModel> Items { get; set; } = Enumerable.Empty<WorkItemViewModel>();

    [Parameter] public bool IsConnected { get; set; }

    [Parameter] public bool IsKeyboardDragTarget { get; set; }

    [Parameter] public EventCallback<WorkItemViewModel> OnCardClick { get; set; }

    [Parameter] public EventCallback<WorkItemViewModel> OnCardEdit { get; set; }

    private int ItemCount => Items.Count();

    private BadgeStyle HeaderBadgeStyle => Status switch
    {
        "backlog" => BadgeStyle.Light,
        "todo" => BadgeStyle.Info,
        "in_progress" => BadgeStyle.Warning,
        "review" => BadgeStyle.Secondary,
        "done" => BadgeStyle.Success,
        _ => BadgeStyle.Light
    };

}